<div class="card mt-4 col-sm-10">
  <div class="card-header row justify-content-between">
    <div class="col-sm">
      <h4>Summary of Recent Transactions</h4>
    </div>
    <div>
      <button routerLink="/reports" class="btn btn-outline-dark">
        Close &times;
      </button>
    </div>
  </div>
  <div class="card-body">
    <div *ngIf="!summary" class="spinner-border spinner-border-sm"></div>
    <div class="row">
      <div class="col-sm">
        <table class="table table-striped table-hover table-responsive w-auto">
          <thead>
            <tr>
              <th>Month</th>
              <th>Bank</th>
              <th>Count</th>
              <th>Sum</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of summary" (click)="summaryRowSelected(item)">
              <th>
                <span class="text-dark">{{ item.index }}</span>
              </th>
              <td class="text-center">
                {{ bankAccounts[item.bankID - 1].name }}
              </td>
              <td class="text-center d-none d-sm-table-cell">
                {{ item.count }}
              </td>
              <td class="text-center">{{ item.sum | number: "1.2-2" }}</td>
            </tr>
            <tr>
              <td>Total</td>
              <td class="text-center">
                <strong>{{ count }}</strong>
              </td>
              <td class="d-none d-sm-table-cell"></td>
              <td class="text-center">
                <strong>Â£{{ total | number: "1.2-2" }}</strong>
              </td>
            </tr>
            <tr *ngIf="!summary">
              <td colspan="4" class="text-center">
                <span
                  class="spinner-border spinner-border-lg align-center"
                ></span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="col-sm">
        <div class="p-4">
          <form [formGroup]="form">
            <div class="input-group">
              <span class="input-group-text col-4" id="period-label">Period</span>
              <select
                class="form-control"
                #selectList
                (change)="onDateRangeChanged(selectList.value)"
                formControlName="dateRange"
              >
                <option disabled selected [ngValue]="null">-- select --</option>
                <option
                  *ngFor="let dtRng of DateRange | keyvalue: originalOrder"
                  value="{{ dtRng.value }}"
                >
                  {{ dtRng.value }}
                </option>
              </select>
            </div>
            <div class="col-sm-auto">
              <div class="input-group col p-0 mb-1">
                <input
                  class="form-control"
                  placeholder="Start"
                  name="dp1"
                  ngbDatepicker
                  #d1="ngbDatepicker"
                  formControlName="startDate"
                  id="inputStartDate"
                  placement="top"
                />
                <div class="input-group-append">
                  <button
                    class="btn btn-outline-secondary"
                    (click)="d1.toggle()"
                    type="button"
                  >
                    <i class="far fa-calendar-alt"></i>
                  </button>
                </div>
              </div>
            </div>
            <div class="col-sm-auto pl-2 pt-2">and</div>
            <div class="col-sm-auto">
              <div class="input-group col p-0 mb-1">
                <input
                  class="form-control"
                  placeholder="End"
                  name="dp2"
                  ngbDatepicker
                  #d2="ngbDatepicker"
                  formControlName="endDate"
                  id="inputEndDate"
                  placement="top"
                />
                <div class="input-group-append">
                  <button
                    class="btn btn-outline-secondary"
                    (click)="d2.toggle()"
                    type="button"
                  >
                    <i class="far fa-calendar-alt"></i>
                  </button>
                </div>
              </div>
            </div>
            
            <div class="input-group mt-4">
              <span class="input-group-text col-4" id="bank-label">Bank</span>
              <select
                class="form-control"
                #selectList
                (change)="onBankChanged(selectList.value)"
                formControlName="bank"
              >
                <option selected [ngValue]="null">Any</option>
                <option *ngFor="let bank of bankAccounts" value="{{ bank.id }}">
                  {{ bank.name }}
                </option>
              </select>
            </div>
            <div *ngIf="true">
              <p>Form Value: {{ form.value | json }}</p>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="card mt-4 col-sm">
  <transactions-detail
    [bankAccounts]="bankAccounts"
    [summaryRow]="selectedRow"
  ></transactions-detail>
</div>
